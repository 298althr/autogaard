<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Logistics & Customs | AutoGaard Workshop</title>
    <link rel="stylesheet" href="../css/theme.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/components.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: 'var(--primary)', 'primary-dark': 'var(--primary-dark)', 'bg-body': 'var(--bg-body)',
                        'bg-surface': 'var(--bg-surface)', 'bg-surface-elevated': 'var(--bg-surface-elevated)',
                        'text-primary': 'var(--text-primary)', 'text-secondary': 'var(--text-secondary)', 'border-color': 'var(--border-color)',
                    },
                    fontFamily: { bebas: ['Bebas Neue', 'sans-serif'], display: ['Rajdhani', 'sans-serif'], body: ['Inter', 'sans-serif'], }
                }
            }
        }
    </script>
    <style>
        html,
        body {
            background-color: var(--bg-body) !important;
            margin: 0;
            padding: 0;
        }

        .page-wrapper {
            background-color: var(--bg-body);
        }

        .hub-card {
            border: 1px solid var(--border-color);
            background: var(--bg-surface);
            transition: all 0.3s;
            cursor: pointer;
        }

        .hub-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .hub-card .icon-box {
            transition: all 0.3s;
        }

        .hub-card:hover .icon-box {
            background: var(--primary);
            color: white;
        }
    </style>
    <script src="../js/theme.js"></script>
    <script src="js/garage-data.js"></script>
    <script src="js/registration-services.js"></script>
</head>

<body class="bg-bg-body text-text-primary">
    <div class="page-wrapper container pb-32">
        <header class="app-header">
            <button onclick="window.history.back()" class="p-2 -ml-2"><span
                    class="material-symbols-outlined text-text-primary">arrow_back</span></button>
            <h1 class="header-title uppercase tracking-widest">Logistics</h1>
            <div class="w-10"></div>
        </header>

        <main class="animate-fade-in px-gutter">
            <!-- VEHICLE CONTEXT -->
            <div id="vehicle-card" class="mb-6 mt-4"></div>

            <p class="text-[10px] font-black uppercase tracking-[0.2em] text-primary/60 mb-4 px-1">Global & Local
                Logistics</p>

            <!-- Customs Calculator -->
            <div onclick="openCalculator()" class="hub-card rounded-3xl p-5 flex items-center gap-4 cursor-pointer">
                <div class="icon-box w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary">
                    <span class="material-symbols-outlined">calculate</span>
                </div>
                <div class="flex-1">
                    <h3 class="text-sm font-bold tracking-widest uppercase">Duties Calculator</h3>
                    <p class="text-[8px] text-text-secondary uppercase tracking-widest leading-tight">Instant estimate
                        for terminal release.</p>
                </div>
                <span class="material-symbols-outlined text-text-secondary">chevron_right</span>
            </div>

            <!-- Port Clearing & Duty -->
            <div onclick="navigateTo('customs')" class="hub-card rounded-3xl p-5 flex items-center gap-4">
                <div class="icon-box w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary">
                    <span class="material-symbols-outlined">verified</span>
                </div>
                <div class="flex-1">
                    <h3 class="text-sm font-bold tracking-widest uppercase">Port Clearing & Duty</h3>
                    <p class="text-[8px] text-text-secondary uppercase tracking-widest leading-tight">Fast-track
                        terminal release & duty payment.</p>
                    <div class="mt-2 flex gap-2">
                        <span
                            class="px-2 py-0.5 bg-primary/5 text-primary border border-primary/10 rounded text-[7px] font-bold">Lagos
                            Port</span>
                        <span
                            class="px-2 py-0.5 bg-primary/5 text-primary border border-primary/10 rounded text-[7px] font-bold">PTML</span>
                    </div>
                </div>
                <span class="material-symbols-outlined text-text-secondary">chevron_right</span>
            </div>

            <!-- Terminal Logistics -->
            <div onclick="navigateTo('logistics')" class="hub-card rounded-3xl p-5 flex items-center gap-4">
                <div class="icon-box w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary">
                    <span class="material-symbols-outlined">local_shipping</span>
                </div>
                <div class="flex-1">
                    <h3 class="text-sm font-bold tracking-widest uppercase">Interstate Haulage</h3>
                    <p class="text-[8px] text-text-secondary uppercase tracking-widest leading-tight">Secured flatbed or
                        closed-container moves.</p>
                </div>
                <span class="material-symbols-outlined text-text-secondary">chevron_right</span>
            </div>

            <!-- Valuation -->
            <div onclick="navigateTo('valuation')" class="hub-card rounded-3xl p-5 flex items-center gap-4">
                <div class="icon-box w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary">
                    <span class="material-symbols-outlined">analytics</span>
                </div>
                <div class="flex-1">
                    <h3 class="text-sm font-bold tracking-widest uppercase">Exit Valuation</h3>
                    <p class="text-[8px] text-text-secondary uppercase tracking-widest leading-tight">AI-driven resale
                        audit & buy-back offer.</p>
                </div>
                <span class="material-symbols-outlined text-text-secondary">chevron_right</span>
            </div>

            <!-- ELABORATE BUSINESS MODEL SECTION -->
            <div class="mt-10 space-y-8">
                <!-- PRICING ARCHITECTURE -->
                <section>
                    <h4 class="text-[10px] font-black uppercase tracking-[0.2em] text-primary mb-4 px-1">How We Price
                    </h4>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="bg-bg-surface-elevated p-4 rounded-2xl border border-white/5">
                            <p class="text-[8px] font-black uppercase text-text-secondary mb-1">Local Move</p>
                            <p class="text-xs font-bold text-text-primary">Flat Rate Pricing</p>
                            <p class="text-[7px] text-text-secondary uppercase mt-2">Starting at ₦150k within Lagos
                                Terminal zones.</p>
                        </div>
                        <div class="bg-bg-surface-elevated p-4 rounded-2xl border border-white/5">
                            <p class="text-[8px] font-black uppercase text-text-secondary mb-1">Clearing</p>
                            <p class="text-xs font-bold text-text-primary">Fixed % Commission</p>
                            <p class="text-[7px] text-text-secondary uppercase mt-2">Transparent commission on official
                                duty rates.</p>
                        </div>
                    </div>
                </section>

                <!-- SERVICE PROTOCOL -->
                <section>
                    <h4 class="text-[10px] font-black uppercase tracking-[0.2em] text-primary mb-4 px-1">Movement
                        Protocol</h4>
                    <div class="space-y-4">
                        <div class="flex gap-4">
                            <div
                                class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs">
                                1</div>
                            <div class="flex-1">
                                <p class="text-[9px] font-bold uppercase tracking-widest">Digital Paper Audit</p>
                                <p class="text-[8px] text-text-secondary uppercase mt-1">Upload Bill of Lading or Title.
                                    Our AI verifies duty integrity within 2 hours.</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <div
                                class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs">
                                2</div>
                            <div class="flex-1">
                                <p class="text-[9px] font-bold uppercase tracking-widest">Secured Logistics</p>
                                <p class="text-[8px] text-text-secondary uppercase mt-1">Movement by AutoGaard certified
                                    haulage partners with real-time GPS tracking.</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <div
                                class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs">
                                3</div>
                            <div class="flex-1">
                                <p class="text-[9px] font-bold uppercase tracking-widest">Doorstep Handover</p>
                                <p class="text-[8px] text-text-secondary uppercase mt-1">Final 10-point arrival
                                    inspection before keys are released to client.</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <nav class="bottom-nav">
            <a href="../dashboard.html" class="nav-item"><span class="material-symbols-outlined">grid_view</span><span
                    class="nav-label">Home</span></a>
            <a href="../fleet.html" class="nav-item"><span class="material-symbols-outlined">explore</span><span
                    class="nav-label">Fleet</span></a>
            <a href="../garage.html" class="nav-item active"><span
                    class="material-symbols-outlined">directions_car</span><span class="nav-label">Garage</span></a>
            <a href="../inquiries.html" class="nav-item"><span class="material-symbols-outlined">forum</span><span
                    class="nav-label">Concierge</span></a>
            <a href="../settings.html" class="nav-item"><span class="material-symbols-outlined">tune</span><span
                    class="nav-label">Settings</span></a>
        </nav>
    </div>

    <!-- CALCULATOR MODAL -->
    <div id="calc-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-md" onclick="closeCalculator()"></div>
        <div class="absolute bottom-0 left-0 right-0 bg-bg-surface rounded-t-[3rem] p-8 pb-12 border-t border-white/10 max-h-[90vh] overflow-y-auto translate-y-full transition-transform duration-500 ease-out"
            id="modal-content">
            <div class="w-12 h-1.5 bg-white/10 rounded-full mx-auto mb-8"></div>

            <h2 class="text-2xl font-[var(--font-bebas)] tracking-[0.2em] mb-2 uppercase">Customs Duty Calculator</h2>
            <p class="text-[10px] text-text-secondary uppercase tracking-widest mb-8">Determine terminal clearing costs
                & AutoGaard commission.</p>

            <div class="space-y-6">
                <div>
                    <label class="text-[10px] font-bold uppercase tracking-widest text-text-secondary mb-2 block">Value
                        (FOB USD)</label>
                    <input type="number" id="fob-input" placeholder="e.g. 5000"
                        class="w-full bg-bg-body border border-border-color rounded-2xl p-4 text-sm focus:border-primary outline-none transition-all">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label
                            class="text-[10px] font-bold uppercase tracking-widest text-text-secondary mb-2 block">Exc.
                            Rate</label>
                        <input type="number" id="rate-input" value="1620"
                            class="w-full bg-bg-body border border-border-color rounded-2xl p-4 text-sm focus:border-primary outline-none transition-all">
                    </div>
                    <div>
                        <label
                            class="text-[10px] font-bold uppercase tracking-widest text-text-secondary mb-2 block">Engine</label>
                        <select id="engine-input"
                            class="w-full bg-bg-body border border-border-color rounded-2xl p-4 text-sm focus:border-primary outline-none transition-all appearance-none">
                            <option value="ice">Petrol</option>
                            <option value="ev">Electric</option>
                        </select>
                    </div>
                </div>

                <button onclick="runCalculation()"
                    class="w-full py-4 bg-primary text-white rounded-2xl font-bold uppercase tracking-widest hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2 shadow-lg shadow-primary/20">
                    <span class="material-symbols-outlined">model_training</span>
                    RUN AutoGaard ALGORITHM
                </button>

                <!-- Results -->
                <div id="results-area" class="hidden space-y-4 pt-6 mt-6 border-t border-white/5 animate-fade-in">
                    <div class="bg-bg-body rounded-2xl p-6 border border-white/5 space-y-4">
                        <div
                            class="flex justify-between items-center text-[10px] uppercase tracking-widest text-text-secondary">
                            <span>Government Duties</span>
                            <span id="res-govt" class="font-bold text-text-primary">₦0</span>
                        </div>
                        <div
                            class="flex justify-between items-center text-[10px] uppercase tracking-widest text-primary font-bold">
                            <span>AutoGaard Service (15%)</span>
                            <span id="res-comm" class="font-bold">₦0</span>
                        </div>
                        <div class="h-px bg-white/5"></div>
                        <div class="flex justify-between items-center">
                            <span class="text-xs uppercase tracking-[0.2em] font-black text-text-primary">Estimated
                                Total</span>
                            <span id="res-total"
                                class="text-xl font-[var(--font-bebas)] tracking-widest text-primary">₦0</span>
                        </div>
                    </div>

                    <button onclick="saveAndBook()"
                        class="w-full py-4 bg-white text-black rounded-2xl text-[10px] font-bold uppercase tracking-widest hover:brightness-90 transition-all">
                        Book Clearing Agent Now
                    </button>
                    <p class="text-[8px] text-text-secondary uppercase text-center tracking-widest">Final quote subject
                        to physical port appraisal.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let activeVehicle = null;
        let lastCalculation = null;

        function init() {
            activeVehicle = GarageData.getActiveVehicle();
            if (!activeVehicle) {
                window.location.href = 'select-vehicle.html?service=logistics-hub';
                return;
            }
            RegistrationServices.renderVehicleCard(activeVehicle, 'vehicle-card');
        }

        function navigateTo(service) {
            window.location.href = `${service}.html?vid=${activeVehicle.id}`;
        }

        // --- CALCULATOR LOGIC ---
        function openCalculator() {
            const modal = document.getElementById('calc-modal');
            const content = document.getElementById('modal-content');
            modal.classList.remove('hidden');
            setTimeout(() => content.classList.remove('translate-y-full'), 10);
        }

        function closeCalculator() {
            const content = document.getElementById('modal-content');
            content.classList.add('translate-y-full');
            setTimeout(() => document.getElementById('calc-modal').classList.add('hidden'), 500);
        }

        function runCalculation() {
            const fob = parseFloat(document.getElementById('fob-input').value);
            const rate = parseFloat(document.getElementById('rate-input').value);
            const engine = document.getElementById('engine-input').value;

            if (!fob || !rate) {
                alert('Specify FOB and Rate');
                return;
            }

            const results = GarageData.Calculators.calculateCustoms(fob, rate, engine);
            lastCalculation = results;

            document.getElementById('res-govt').textContent = GarageData.formatCurrency(results.totalDuty);
            document.getElementById('res-comm').textContent = GarageData.formatCurrency(results.commission);
            document.getElementById('res-total').textContent = GarageData.formatCurrency(results.grandTotal);

            document.getElementById('results-area').classList.remove('hidden');
        }

        function saveAndBook() {
            if (!lastCalculation) return;

            const record = GarageData.createServiceRecord({
                vehicleId: activeVehicle.id,
                type: 'customs',
                title: 'Port Clearing & Customs Duty',
                invoiceTotal: lastCalculation.grandTotal,
                partnerName: 'AutoGaard Logistics Hub',
                details: {
                    fob: document.getElementById('fob-input').value,
                    exchangeRate: document.getElementById('rate-input').value,
                    results: lastCalculation
                },
                lineItems: [
                    { name: 'Government Customs Duty', price: lastCalculation.totalDuty },
                    { name: 'AutoGaard Service & Handling', price: lastCalculation.commission }
                ]
            });

            alert('Request Logged! Redirecting to tracking...');
            window.location.href = '../dashboard.html';
        }

        init();
    </script>
</body>

</html>
